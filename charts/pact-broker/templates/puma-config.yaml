apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "chart.fullname" . }}-puma-config
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "chart.labels" . | nindent 4 }}
data:
  puma.rb: |
    # Puma configuration for Pact Broker
    # Only bind to IPv4 to avoid port conflicts with IPv6
    bind "tcp://0.0.0.0:{{ .Values.broker.containerPorts.http }}?ipv6=false"
    environment "production"
    threads 0, 5
    workers 0
